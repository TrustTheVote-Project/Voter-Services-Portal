- updating ||= false

#options.section{ 'data-bind' => 'vis: page() == "options"' }
  .head
    %h3 Options
    .description Select only applicable options (not required).

  .partition
    .row
      .span10
        .checkbox
          = f.check_box :choose_party, { 'data-bind' => 'checkedWithInit: chooseParty' }
          %strong I want to choose a political party preference.

    <!-- ko if: chooseParty -->
    .row
      .span3
        %p My political party preference is

        = f.select :party, Dictionaries::PARTIES + [ [ "Other", "other" ] ], { include_blank: true }, { autocomplete: ac, 'data-bind' => 'instantValidation: { accessor: "party" }' }

      <!-- ko if: party() == 'other' -->
      .span3
        %span Political party preference name
        = f.text_field :other_party, autocomplete: ac, 'data-bind' => 'valueWithInit: otherParty'
      <!-- /ko -->

    <!-- /ko -->

  .partition
    .row
      .span12
        .checkbox
          = f.check_box :is_confidential_address, autocomplete: ac, 'data-bind' => 'checkedWithInit: isConfidentialAddress'
          %strong I qualify for address confidentiality.

    <!-- ko if: isConfidentialAddress -->
    .row
      .span10
        %span I request that my home address not be released because I or member of my household is
        - %w( LEO CPO TSC ACP ).each do |r|
          .radio
            = f.radio_button :ca_type, r, 'data-bind' => 'checkedWithInit: caType'
            %label= Dictionaries::ACP_REASONS[r]

        <!-- ko if: caType -->
        .additional
          .important In order to non-publish your residence address in voter lists, you must also provide an alternative post office box mailing address within Virginia to be used on the voter lists.
          .row
            .span5
              %span P.O. Box
              = f.text_field :ca_po_box, autocomplete: ac, placeholder: 'Box number', maxlength: 20, 'data-bind' => 'instantValidation: { accessor: "caPoBox" }'
          .row
            .span3.town
              %span City / Town
              = f.text_field :ca_city, autocomplete: ac, 'data-bind' => 'instantValidation: { accessor: "caCity" }'
            .span1
              %span State
              VA
            .span2.zip-field
              %span Zip code
              = f.text_field :ca_zip5, maxlength: 5, autocomplete: ac, class: 'first-zip', 'data-bind' => 'instantValidation: { accessor: "caZip5", validation: "zip5" }', placeholder: 'NNNNN'
              .space &mdash;
              = f.text_field :ca_zip4, maxlength: 4, autocomplete: ac, class: 'second-zip', placeholder: 'NNNN'

          <!-- ko if: caType() == 'in fear' -->
          .important You must attach copy of the complaint that you filed
          <!-- /ko -->
        <!-- /ko -->
    <!-- /ko -->

  = render partial: 'domestic_absentee', locals: { f: f, updating: updating }
  = render partial: 'overseas_absentee', locals: { f: f, updating: updating }

  = hidden_field_tag 'registration[be_official]', '0'
  <!-- ko if: domestic -->
  .partition
    .row
      .span12
        .checkbox
          = f.check_box :be_official, autocomplete: ac
          %strong
            I'm interested in being an Election Official on Election Day. Please send me information.
  <!-- /ko -->

  .form-actions
    = button_tag 'Next &rarr;'.html_safe, class: 'next btn', 'data-bind' => 'click: nextPage, css: { disabled: optionsInvalid }'
    = button_tag '&larr; Back'.html_safe, class: 'back btn', 'data-bind' => 'click: prevPage'
